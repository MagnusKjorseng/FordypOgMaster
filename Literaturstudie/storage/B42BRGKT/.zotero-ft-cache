Part Two
Motion Control
De Motu Gubernando
Handbook of Marine Craft Hydrodynamics and Motion Control, First Edition. Thor I. Fossen.
© 2011 John Wiley & Sons Ltd. Published 2011 by John Wiley & Sons Ltd. ISBN: 978-1-119-99149-6


9
Introduction
Guidance, navigation and control (GNC) deals with the design of systems that automatically control or remotely control devices or vehicles that are moving under water, on the surface or in space. While Part I of the textbook is dedicated to modeling of marine craft in 6 degrees of freedom, Part II deals with the design of model-based GNC systems. The theory and cases studies are organized as four independent chapters:
Chapter 10: Guidance Systems: Systems for automatically guiding the path of a marine craft, usually without direct or continuous human control. Chapter 11: Sensor and Navigation Systems: Systems for determination of the craft’s position/ attitude, velocity and acceleration. Chapter 12: Motion Control Systems: PID design methods for automatic control of position/attitude, velocity and acceleration. This involves control systems for stabilization, trajectory-tracking and pathfollowing control of marine craft. Chapter 13: Advanced Motion Control Systems: Design of advanced motion control systems using optimal and nonlinear control theory.
In each chapter, theory and case studies are presented with focus on the following applications:
• Ship and underwater vehicle autopilots for course-keeping and turning control • Waypoint tracking, trajectory-tracking and path-following control systems for marine craft • Depth autopilots for underwater vehicles • Yacht control systems • Attitude control systems for underwater vehicles • Dynamic positioning (DP) systems for marine craft • Position mooring (PM) systems for floating vessels • Fin and rudder-roll reduction systems • Buoyancy control systems including trim and heel correction systems • Propulsion and forward speed control systems
9.1 Historical Remarks
The history of model-based ship control starts with the invention of the gyrocompass in 1908, which allowed for reliable automatic yaw angle feedback. The gyrocompass was the basic instrument in the
Handbook of Marine Craft Hydrodynamics and Motion Control, First Edition. Thor I. Fossen.
© 2011 John Wiley & Sons Ltd. Published 2011 by John Wiley & Sons Ltd. ISBN: 978-1-119-99149-6


230 Introduction
first feedback control system for heading control and today these devices are known as autopilots. The next breakthrough was the development of local positioning systems in the 1970s. Global coverage using satellite navigation systems was first made available in 1994. Position control systems opened for automatic systems for waypoint tracking, trajectory tracking and path following. The development of local area ship positioning systems such as hydroacoustic reference systems (SSBL, SBL, LBL), hyperbolic radio navigation systems (Decca, Loran-C, Omega), local electromagnetic distance measuring (EDM) systems (Artemis, Autotape, Miniran, Mini-Ranger III, Syledis, Tellurometer, Trident III, Trisponder) and taut wire in conjunction with new results in feedback control contributed to the invention and design of the first dynamic positioning systems for ships and rigs in the late 1970s; see Sections 12.2.10 and 13.1.6. The use of DP systems on a global basis in offshore applications was further strengthened by commercialization of satellite navigation systems. In 1994 Navstar GPS was declared fully operational (global coverage) even though the first satellite was launched in 1974 (Parkinson and Spilker, 1995). GPS receivers are standard components in waypoint tracking control systems and ship positioning systems worldwide. They are used commercially and by numerous naval forces. Today, three Global Navigation Satellite Systems (GNSS) are commercially available: Navstar GPS (USA), GLONASS (Russia) and GALILEO (European Union).
9.1.1 The Gyroscope and its Contributions to Ship Control
During the 1850s the French scientist J. B. L. Foucault conducted experiments with a wheel (rotor) mounted in gimbal rings, that is a set of rings that permit it to turn freely in any direction. The name gyroscope was adopted for this device. In the experiments Foucault noticed that the spinning wheel maintained its original orientation in space regardless of the Earth’s rotation. In Encyclopedia Britannica the following definition is given for a gyroscope:
Gyroscope: any device consisting of a rapidly spinning wheel set in a framework that permits it to tilt freely in any direction–that is, to rotate about any axis. The momentum of such a wheel causes it to retain its attitude when the framework is tilted; from this characteristic derive a number of valuable applications. Gyroscopes are used in such instruments as compasses and automatic pilots onboard ships and aircraft, in the steering mechanisms of torpedoes, in antiroll equipment on large ships and in inertial guidance systems.
The first recorded construction of the gyroscope is usually credited to C. A. Bohnenberger in 1810, while the first electrically driven gyroscope was demonstrated in 1890 by G. M. Hopkins (see Allensworth, 1999, Bennet, 1979). The development of the electrically driven gyroscope was motivated by the need for more reliable navigation systems in steel ships and underwater warfare. A magnetic compass, as opposed to a gyro compass, is highly sensitive to magnetic disturbances, which are commonly found in steel ships and submarines equipped with electrical devices. In parallel works, Dr H. Anschutz of Germany and Elmer Sperry of the USA both worked on the practical application of the gyroscope. In 1908 Anschutz patented the first North-seeking gyrocompass, while Elmer Sperry was granted a patent for his ballistic compass including vertical damping three years later. The invention of the gyroscope was one of the key breakthroughs in automatic ship control since it led to the development of the automatic pilot (Fossen, 2000a). Historic aspects in a motion control perspective are discussed by Fossen (2000b) while Fossen and Perez (2009) discuss Kalman filtering for positioning and heading control of ships and offshore rigs in conjunction with the 50th anniversary of the Kalman–Bucy filter. The pioneering work of J. G. Balchen and coauthors on ship automation and dynamic positioning is discussed in Breivik and Sand (2009).


Historical Remarks 231
9.1.2 Autopilots
The autopilot or automatic pilot is a device for controlling an aircraft, marine craft or other vehicles without constant human intervention. The earliest automatic pilots could do no more than maintain a fixed heading and they are still used to relieve the pilot on smaller boats during routine cruising. For ships, course-keeping capabilities were the first applications. Modern autopilots can, however, execute complex maneuvers, such as turning and docking operations, or enable the control of inherently unstable vessels such as submarines and some large oil tankers. Autopilots are used to steer surface ships, submarines, torpedoes, missiles, rockets and spacecraft among others. As mentioned earlier, the work on the gyrocompass was extended to ship steering and closed-loop control by Elmer Sperry (1860–1930) who constructed the first automatic ship-steering mechanism (see Allensworth, 1999; Bennet, 1979). This device, referred to as the Metal Mike, was a gyroscopeguided autopilot (gyro pilot) or a mechanical helmsman. The first field trials of the Sperry standard gyro pilot were conducted in 1922. Metal Mike emulated much of the behavior of a skilled pilot or a helmsman, including compensating for varying sea states using feedback control and automatic gain adjustments. Nicholas Minorsky (1885–1970) presented a detailed analysis of a position feedback control system where he formulated a three-term control law which is today known as proportional-integral-derivative (PID) control (see Minorsky, 1922). Observing the way in which a helmsman steered a ship motivated these three different behaviors. In Bennet (1979), there is an interesting analysis of the work of Sperry and Minorsky and their contributions to autopilot design. The autopilot systems of Sperry and Minorsky were both single-input single-output (SISO) control systems, where the heading (yaw angle) of the ship was measured by a gyrocompass. Today, this signal is fed back to a computer, in which a PID control system (autopilot) is implemented in software (see Section 12.2.6). The autopilot compares the pilot setpoint (desired heading) with the measured heading and computes the rudder command, which is then transmitted to the rudder servo for corrective action. More recently PID-type autopilots have been replaced by autopilots based on linear quadratic Gaussian (LQG) and H∞-control design techniques. One of the advantageous features of these design techniques is that they allow for frequency-dependent notch filtering of first-order wave-induced forces (see Chapter 11). Frequency components around the peak frequency of the wave spectrum in yaw must be prevented from entering the feedback loop in order to avoid wear and tear of the thruster and propeller systems. The drawback of the PID controller in cascade with a deadband, notch and/or low-pass filter is that additional phase lag and nonlinearities are introduced in the closed-loop system (see Section 11.1). A model-based state estimator (Kalman filter) reduces these problems. Linear quadratic and H∞ autopilot designs have been reported in the literature by a large number of authors; see Koyama (1967), Norrbin (1972), Van Amerongen and Van Nauta Lemke (1978, 1980), Donha et al. (1998), Tzeng (1998b) and Fossen (1994) and references therein, to mention only some. In addition to LQG and H∞ control, other design techniques have been applied to ship autopilot designs, for instance nonlinear control theory. Autopilot designs for nonlinear systems are treated in detail in Section 13.3.
9.1.3 Dynamic Positioning and Position Mooring Systems
The great successes with PID-based autopilot systems and the development of local area positioning systems suggest that three decoupled PID controllers could be used to control the horizontal motion of a ship in surge, sway and yaw exclusively by means of thrusters and propellers. The idea was tested in the 1970s, and the invention was referred to as a dynamic positioning (DP) system. PID designs for DP are presented in Section 12.2.10 while optimal DP is discussed in Section 13.1.6


232 Introduction
As for the autopilot systems, a challenging problem was to prevent first-order wave-induced forces entering the feedback loop. Several techniques such as notch and low-pass filtering, and the use of dead-band techniques, were tested for this purpose, but with varying levels of success. In 1960–1961 the Kalman filter was published by Kalman (1960) and Kalman and Bucy (1961). Two years later in 1963, the theory for the linear quadratic (LQ) optimal controller was available. This motivated the application of LQG controllers in MIMO ship control such as DP since a state observer (Kalman filter) could be used to estimate the wave frequency (WF) and the ship low-frequency (LF) motions; see Section 11.3.6 and Figure 12.23 in Section 12.2.10. Another advantage of a MIMO control strategy was that the interactions between the surge, sway and yaw modes could be dealt with. This is not possible with three decoupled PID controllers. The LQG design technique was first applied to DP by Balchen et al. (1976, 1980a, 1980b) and Grimble et al. (1979, 1980a). Later Grimble and coauthors suggested to use H∞ and μ-optimal methods for filtering and control (Katebi et al., 1997a). These methods have been further refined by Katebi et al. (1997b) where the nonlinear thruster dynamics is included using describing functions. After 1995, nonlinear PID control, passive observer design and observer backstepping designs have been applied to DP by Fossen and coauthors with good results; see Grøvlen and Fossen (1996), Fossen and Grøvlen (1998), Strand (1999) and references therein. An overview of DP systems is found in Strand and Sørensen (2000) while extensions to PM systems are presented in Strand (1999). DP and PM systems are discussed in more detail in Sections 12.2.10 and 13.1.6.
9.1.4 Waypoint Tracking and Path-Following Control Systems
The successful results with LQG controllers in ship autopilots and DP systems, and the availability of global navigation systems such as GPS and GLONASS, resulted in a growing interest in waypoint tracking and path-following control systems; see Holzh ̈uter and Schultze (1996), Holzh ̈uter (1997), Fossen et al. (2003b), Skjetne et al. (2004), Breivik and Fossen (2009) and references therein. The transformation of the waypoints to a feasible path or trajectory is in general a nonlinear optimization problem. This is discussed in Chapter 10. Motion controllers can be designed using linear theory or by treating the control problem as nonlinear; see Sections 12.2.7–12.2.9 and 13.3.12. Guidance systems for trajectory-tracking and path-following control are discussed in Chapter 10, while maneuverability and autopilot systems are discussed in Chapters 12–13.
9.2 The Principles of Guidance, Navigation and Control
A motion control system is usually constructed as three independent blocks denoted as the guidance, navigation and control (GNC) systems. These systems interact with each other through data and signal transmission as illustrated in Figure 9.1, where a conventional ship autopilot is shown. In more advanced GNC systems, these blocks could be more tightly coupled and even represented by one block. Loose and tight coupling is a trade-off between modularity and high performance. From an industrial point of view it is attractive to have a loosely coupled system since this allows for software updates of single blocks. In Figure 9.1 the guidance system makes use of the estimated alternatively measured positions and velocities. This is referred to as a closed-loop guidance system while a guidance system that only uses reference feedforward (no feedback) is an open-loop guidance system (see Figure 9.3).
Definitions of Guidance, Navigation and Control
In its most advanced form, the GNC blocks represent three interconnected subsystems, as shown in Figure 9.1. The tasks of the subsystems are classified according to:


The Principles of Guidance, Navigation and Control 233
Figure 9.1 GNC signal flow.
Guidance is the action or the system that continuously computes the reference (desired) position, velocity and acceleration of a marine craft to be used by the motion control system. These data are usually provided to the human operator and the navigation system (see Figure 9.2). The basic components of a guidance system are motion sensors, external data such as weather data (wind speed and direction, wave height and slope, current speed and direction) and a computer. The computer collects and processes the information, and then feeds the results to the motion control system. In many cases, advanced optimization techniques are used to compute the optimal trajectory or path for the marine craft to follow. This might include sophisticated features such as fuel optimization, minimum time navigation, weather routing, collision avoidance, formation control and synchronization. Navigation is the science of directing a craft by determining its position/attitude, course and distance traveled. In some cases velocity and acceleration are determined as well. This is usually done by using a global navigation satellite system (GNSS) combined with motion sensors such as accelerometers and gyros. The most advanced navigation system for marine applications is the inertial navigation system (INS). Navigation is derived from the Latin navis, “ship”, and agere, “to drive”. It originally denoted the art of ship driving, including steering and setting the sails. The skill is even more ancient than the word itself, and it has evolved over the course of many centuries into a technological science that encompasses the planning and execution of safe, timely and economical operation of ships, underwater vehicles, aircraft and spacecraft. Control, or more specifically motion control, is the action of determining the necessary control forces and moments to be provided by the craft in order to satisfy a certain control objective. The desired control objective is usually seen in conjunction with the guidance system. Examples of control objectives are minimum energy, setpoint regulation, trajectory-tracking, path-following and maneuvering control. Constructing the control algorithm involves the design of feedback and feedforward control laws. The outputs from the navigation system, position, velocity and acceleration are used for feedback control while feedforward control is implemented using signals available in the guidance system and other external sensors.
An autopilot is a GNC system in its most basic form. A state-of-the-art autopilot system consists of a reference model (guidance system), a gyrocompass/observer (navigation system) and an autopilot (control system). This is illustrated in Figure 9.3.


234 Introduction
Figure 9.2 Human operator monitoring the navigation data. Illustration Bjarne Stenberg/Department of Marine Technology, NTNU.
Figure 9.3 Autopilot GNC blocks where the reference model represent an open-loop guidance system.


Control of Underactuated and Fully Actuated Craft 235
9.3 Setpoint Regulation,Trajectory-Tracking and Path-Following Control
When designing motion control systems, the control objective must be well defined in order to satisfy the requirement specifications for safe operation of the craft. In this context, it is important to distinguish between the following three important control objectives:
Setpoint Regulation: The most basic guidance system is a constant input or setpoint provided by a human operator. The corresponding controller will then be a regulator. Examples of setpoint regulation are constant depth, trim, heel and speed control. It could also be regulation to zero, which is commonly required in roll and pitch for instance. Trajectory-Tracking Control: The position and velocity of the marine craft should track desired timevarying position and velocity reference signals. The corresponding feedback controller is a trajectorytracking controller. Tracking control can be used for course-changing maneuvers, speed-changing and attitude control. An advanced guidance system computes optimal time-varying trajectories from a dynamic model for a predefined control objective. If a constant setpoint is used as input to a low-pass filter (reference model) in an open-loop guidance system, the outputs of the filter will be smooth time-varying reference trajectories for position, velocity and acceleration (PVA). Path-Following Control: This is to follow a predefined path independent of time (no temporal constraints). Moreover, no restrictions are placed on the temporal propagation along the path. This is typical for ships in transit between continents or underwater vehicles used to map the seabed.
As soon as the control objective is determined, a motion control system can be designed to satisfy the requirements. Methods for this are presented in Chapters 12–13.
9.4 Control of Underactuated and Fully Actuated Craft
When designing motion control systems for marine craft, it is important to distinguish between:
• Underactuated marine craft • Fully actuated marine craft
It is trivial to control a fully actuated marine craft while underactuation puts limitations on what control objectives can be satisfied. More specifically, the control objective must be formulated such that the craft can satisfy all requirements even if it is equipped with actuators that purely produce forces in some directions. Unfortunately, most marine craft are underactuated since they cannot produce control forces and moments in all DOFs.
Definition 9.1 (Degree-of-Freedom (DOF))
For a marine craft, DOF is the set of independent displacements and rotations that completely specify the displaced position and orientation of the craft. A craft that can move freely in the 3-D space has a maximum of 6 DOFs, three translational and three rotational components.
Consequently, a fully actuated marine craft operating in 6 DOF must be equipped with actuators that can produce independent forces and moments in all directions. When simulating the motion of such a craft, a total of 12 ordinary differential equations are needed since the order of the system is
Order = 2 × DOF (9.1)
In many cases this is not practical. For instance, a ship can be equipped with a single rudder and a propeller. Hence, the motion control system cannot satisfy a 6 DOF control objective. It is still possible


236 Introduction
to control the ship if the control objective is path-following control for instance. The reason for this is that two control inputs can be used to satisfy two control objectives even though the ship moves in 6 DOF. More specifically:
Control systems for underactuated and fully actuated marine craft are designed by defining a workspace in which the control objective is specified.
In order to investigate this, it is necessary to define the configuration space and workspace of a marine craft.
9.4.1 Configuration Space
The configuration space of a marine craft is defined as:
Definition 9.2 (Configuration Space)
The n-dimensional configuration space is the space of possible positions and orientations that a craft may attain, possibly subject to external constraints.
The configuration of a marine craft can be uniquely described by an n-dimensional vector of generalized coordinates, that is the least number of coordinates needed to specify the state of the system. If k geometric constraints exist,
hi(η) = 0, i = 1, .., k (9.2)
the possible motions of the craft are restricted to an (n − k)-dimensional submanifold.
Example 9.1 (6 DOF Motions)
For a marine craft operating in 6 DOF, the displacements and rotations are described by n = 6 generalized positions and velocities
η = [x, y, z, φ, θ, ψ] ∈ R3 × S3 (9.3)
ν = [u, v, w, p, q, r] ∈ R6 (9.4)
where the Euler angles φ, θ and ψ are defined on the interval S = [0, 2π]. Thus the order of the system is 12. This is typically the case for underwater vehicles.
Example 9.2 (3 DOF Motions)
For a marine craft restricted to operate in the horizontal plane (surge, sway and yaw), n = 3 generalized positions and velocities
η = [x, y, ψ] ∈ R2 × S (9.5)
ν = [u, v, r] ∈ R3 (9.6)
are needed to describe the motions. Thus the order of the system is 6. This is typically the case for ships and offshore rigs.
In this context, an underactuated marine craft is defined as:
Definition 9.3 (Underactuated Marine Craft)
A marine craft is underactuated if it has less control inputs than generalized coordinates (r < n).


Control of Underactuated and Fully Actuated Craft 237
Definition 9.4 (Fully Actuated Marine Craft)
A marine craft is fully actuated if it has equal or more control inputs than generalized coordinates (r ≥ n).
From this it follows that a marine craft that operates in n DOF has a configuration space of dimension dim(η) = n. If the craft only has actuators in surge, sway and yaw, the craft is underactuated in the sense of operation in 6 DOF while the design of a motion control system for the horizontal plane motion (dynamic positioning) can be achieved using only three control inputs. Underwater vehicles that have actuators that produce independent forces and moments in 6 DOF are fully actuated. Hence, it makes sense to look at the number of actuators needed (see Figure 9.4) to control motions in a space of dimension m < n instead of always formulating the control objective in n DOF. This suggests that the control objective should be formulated in the workspace of the craft and not the configuration space when designing motion control systems.
9.4.2 Workspace and Control Objectives
The workspace is defined as:
Definition 9.5 (Workspace)
The workspace is a reduced space of dimension m < n in which the control objective is defined.
The workspace of a conventional heading autopilot system is m = 1 since only the yaw motion is controlled. Similarly, the workspace of a horizontal plane controller, for instance a DP system controlling the motions in surge, sway and yaw, is m = 3.
Figure 9.4 Azimuth thrusters for actuation in surge, sway and yaw. Illustration by Bjarne Stenberg/ MARINTEK.


238 Introduction
Let n be the dimension of the configuration space, m the dimension of the workspace and r denote the number of independently controlled actuators spanning different directions in the configuration space. Hence, we can make the following statements:
• Full actuation means that independent control forces and moments are simultaneously available in all directions. Moreover, all positions in the configuration space have actuation such that r = n. • An underactuated marine craft has independent control forces and moments in only some DOF. Moreover, r < n. Stabilizing and tracking controllers for underactuated craft are usually designed by considering a workspace of dimension m < n satisfying m = r (fully actuated in the workspace but not in the configuration space). • Underactuated control is a technical term used in control theory to describe a motion control system for a craft that is underactuated in the workspace (r < m). To design a control system that achieves stabilization, trajectory-tracking and path-following control for this case is nontrivial. These types of system are not considered in this textbook since they are not used in practice.
This means that it is straightforward to design motion control systems for marine craft in the workspace as long as there is a workspace that is fully actuated and satisfies the control objective, that is m = r. One obstacle is that the system must be internally stable when reducing the dimension of the configuration space to a smaller space (workspace) intended for feedback control design. Space reduction implies that the uncontrolled equations of motion will appear as k dynamic constraints that must have bounded solutions in order to avoid the system blowing up.
Example 9.3 (Path-Following Control)
Consider an underactuated craft in the horizontal plane with actuation in surge and yaw (no actuation in sway). A path-following control system is usually designed by using feedback from the heading angle ψ and surge velocity u. Then it is possible to control the speed of the craft along the path using a speed controller and at the same time force the craft on to the path using a heading controller producing rudder commands. The workspace of this system is m = 2 while the motions in surge, sway and yaw corresponds to a configuration space of dimension three (n = 3). Consequently,
m < n (9.7)
but only two controls (r = 2) are needed to satisfy the path-following control objective. However, the uncontrolled sway equation introduces a constraint representing the sway dynamics of the craft. This equation must be stable in order for the overall system to be stable (Fossen et al., 2003b). A case study illustrating this is presented in Section 13.3.12.
Example 9.4 (Dynamic Positioning)
Consider a fully actuated craft operating in the horizontal plane with actuation in surge, sway and yaw (r = 3). A dynamic positioning system can be designed by using feedback from the position (x, y) and the heading angle ψ. The dimension of the workspace is m = 3 and the dimension of the configuration space is n = 3. Hence, m = n = r and it is straightforward to control (x, y, ψ); see Section 12.2.10.
9.4.3 Weathervaning of Underactuated Craft in a Uniform Force Field
Marine craft are usually controlled in surge, sway and yaw by using three controls, that is full actuation. However, unlike wheeled cars and other craft operating on the surface of the Earth, it is possible to stabilize the positions of a marine craft by means of two controls. The main reason for this is that marine craft are


Control of Underactuated and Fully Actuated Craft 239
Figure 9.5 Weathervaning of a tanker. The tanker is aligned in the force field such that the resulting force is acting at the bow along the longitudinal axis.
exposed to drift forces generated by waves, wind and ocean currents. This means that the equations of motion are forced. For stationkeeping, it is common to assume that the drift forces are slowly varying such that the resulting component due to wind, waves and ocean currents can be treated as a constant uniform force. Hence, a marine craft can be modeled as a rigid body operating in a unified force field similar to a pendulum in the gravity field, as explained in Section 13.3.10. This is an appealing idea in stationkeeping since it is possible to align the craft in the force field such that the resulting environmental force is acting at the bow along the longitudinal axis of the craft (see Figure 9.5). This clearly reduces drag for slender bodies and torpedo-shaped vehicles. Another important observation is that it is possible to stabilize a rigid body in a uniformed force field using only two controls (r = 2) even though the configuration space of the craft is surge, sway and yaw, that is m = 3. This is done by using one control to compensate for the drift force that acts along the longitudinal axis of the body. The other controller is designed to align the craft to the force field. This concept is in fact similar to a weathervane which is aligned to the force field created by the wind. Motion control systems can be designed to behave like a weathervane and are used offshore for stationkeeping of supply vessels and tankers near floating structures in order to save energy. The drawback is that stationkeeping using only two controls implies that the desired heading cannot be specified arbitrarily. Simultaneous control of the motions in surge, sway and yaw to arbitrary values requires three controls.